document.getElementById("title-version").innerText=nw.App.manifest.version;var config=SCWP.config.get_all();function handleProxyChange(){SCWP.config.get("proxy").active?nw.App.setProxyConfig("",chrome.extension.getURL("ShinyColors.pac")):nw.App.setProxyConfig("")}config.proxy.active&&nw.App.setProxyConfig("",chrome.extension.getURL("ShinyColors.pac"));var iframe=document.getElementById("iframe"),isAOT=!1;function delete_all_cookies(){win.cookies.getAll({},function(e){var t=e.length;e.forEach(function(e,n){win.cookies.remove({url:"https://"+e.domain+e.path,name:e.name}),n==t-1&&reload_iframe()})})}function reload_iframe(){iframe.contentWindow.location.reload();var e=new CustomEvent("osd-message",{detail:{osd_type:"reload"}});window.dispatchEvent(e)}function toggle_config(){var e=document.getElementById("config"),t=e.style.display;e.style.display="none"==t?"block":"none",e.classList.toggle("hide")}function toggle_fs(){win.toggleFullscreen();var e=new CustomEvent("osd-message",{detail:{osd_type:"fullscreen",fs_status:win.isFullscreen}});window.dispatchEvent(e)}function toggle_aot(){if(!win.isFullscreen){isAOT=!isAOT,win.setAlwaysOnTop(isAOT);var e=new CustomEvent("osd-message",{detail:{osd_type:"aot",aot_status:!isAOT}});window.dispatchEvent(e)}}document.querySelectorAll("#config input").forEach(function(e,t){var n=e.getAttribute("config-area"),o=e.getAttribute("config-property"),i=e.getAttribute("type").toLowerCase(),s=config[n][o];"checkbox"==i&&(e.checked=s),e.addEventListener("change",function(e){var t=SCWP.config.get(n);"checkbox"==i&&(e.target.checked,t[o]=s),SCWP.config.set(n,t)})}),document.querySelectorAll("#config button").forEach(function(e,t){e.addEventListener("click",function(e){"delete-cookies"==e.target.getAttribute("config-custom")&&1==e.shiftKey&&(delete_all_cookies(),toggle_config())})}),document.querySelector("#iframe").onload=function(){if(-1!=iframe.contentDocument.location.hostname.indexOf("shinycolors.enza.fun")){var e=iframe.contentDocument.createElement("script");e.src=chrome.extension.getURL("hiori/injects.js"),iframe.contentDocument.head.appendChild(e)}iframe.contentDocument.onkeydown=function(e){27==e.which&&(win.isFullscreen&&(e.preventDefault(),toggle_fs()));122==e.which&&(e.preventDefault(),toggle_fs()),(1==e.ctrlKey&&82==e.which||116==e.which)&&(e.preventDefault(),reload_iframe()),1==e.ctrlKey&&84==e.which&&(e.preventDefault(),toggle_aot())},iframe.focus()},window.addEventListener("osd-message",function(e){if("fullscreen"==e.detail.osd_type){var t=e.detail.fs_status?"off":"on (ESC or F11 to exit)";OSD.new("Fullscreen "+t)}else if("reload"==e.detail.osd_type)OSD.new("Reloading...");else if("aot"==e.detail.osd_type){t=e.detail.aot_status?"off":"on";OSD.new("Always on top "+t)}else console.log("Uncaught type"+e.detail.osd_type)}),win.on("resize",function(e,t){var n=win.isFullscreen,o=document.body.classList.contains("fullscreen");n||t==Math.ceil(9/16*e)+22||(win.height=Math.ceil(9/16*e)+22),n?document.body.classList.add("fullscreen"):!n&&o&&document.body.classList.remove("fullscreen")}),win.on("loaded",function(){iframe.src="https://shinycolors.enza.fun";var e=document.getElementById("pre-message");setTimeout(function(){e.classList.add("hide"),iframe.focus(),setTimeout(function(){e.style.display="none"},2001)},5e3)});